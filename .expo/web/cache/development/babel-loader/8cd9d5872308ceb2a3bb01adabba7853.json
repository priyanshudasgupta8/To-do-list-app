{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"F:\\\\Projects\\\\Book Donation App\\\\book-santa-stage-13\\\\screens\\\\BookRequestScreen.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport db from \"../config\";\nimport firebase from \"firebase\";\nimport { RFValue } from \"react-native-responsive-fontsize\";\nimport { SearchBar, ListItem, Input } from \"react-native-elements\";\nimport MyHeader from \"../components/MyHeader\";\nimport { BookSearch } from \"react-native-google-books\";\n\nvar BookRequestScreen = function (_Component) {\n  _inherits(BookRequestScreen, _Component);\n\n  var _super = _createSuper(BookRequestScreen);\n\n  function BookRequestScreen() {\n    var _this;\n\n    _classCallCheck(this, BookRequestScreen);\n\n    _this = _super.call(this);\n\n    _this.addRequest = function _callee(bookName, reasonToRequest) {\n      var userId, randomRequestId, books;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              userId = _this.state.userId;\n              randomRequestId = _this.createUniqueId();\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(BookSearch.searchbook(bookName, \"AIzaSyASyOjOtJla-X-b3io2eLoaUc_bIRFSIIc\"));\n\n            case 4:\n              books = _context.sent;\n              db.collection(\"requested_books\").add({\n                user_id: userId,\n                book_name: bookName,\n                reason_to_request: reasonToRequest,\n                request_id: randomRequestId,\n                book_status: \"requested\",\n                date: firebase.firestore.FieldValue.serverTimestamp(),\n                image_link: books.data[0].volumeInfo.imageLinks.thumbnail\n              });\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(_this.getBookRequest());\n\n            case 8:\n              db.collection(\"users\").where(\"email_id\", \"==\", userId).get().then().then(function (snapshot) {\n                snapshot.forEach(function (doc) {\n                  db.collection(\"users\").doc(doc.id).update({\n                    IsBookRequestActive: true\n                  });\n                });\n              });\n\n              _this.setState({\n                bookName: \"\",\n                reasonToRequest: \"\",\n                requestId: randomRequestId\n              });\n\n              return _context.abrupt(\"return\", Alert.alert(\"Book Requested Successfully\"));\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.receivedBooks = function (bookName) {\n      var userId = _this.state.userId;\n      var requestId = _this.state.requestId;\n      db.collection(\"received_books\").add({\n        user_id: userId,\n        book_name: bookName,\n        request_id: requestId,\n        bookStatus: \"received\"\n      });\n    };\n\n    _this.getBookRequest = function () {\n      var bookRequest = db.collection(\"requested_books\").where(\"user_id\", \"==\", _this.state.userId).get().then(function (snapshot) {\n        snapshot.forEach(function (doc) {\n          if (doc.data().book_status !== \"received\") {\n            _this.setState({\n              requestId: doc.data().request_id,\n              requestedBookName: doc.data().book_name,\n              bookStatus: doc.data().book_status,\n              requestedImageLink: doc.data().image_link,\n              docId: doc.id\n            });\n          }\n        });\n      });\n    };\n\n    _this.sendNotification = function () {\n      db.collection(\"users\").where(\"email_id\", \"==\", _this.state.userId).get().then(function (snapshot) {\n        snapshot.forEach(function (doc) {\n          var name = doc.data().first_name;\n          var lastName = doc.data().last_name;\n          db.collection(\"all_notifications\").where(\"request_id\", \"==\", _this.state.requestId).get().then(function (snapshot) {\n            snapshot.forEach(function (doc) {\n              var donorId = doc.data().donor_id;\n              var bookName = doc.data().book_name;\n              db.collection(\"all_notifications\").add({\n                targeted_user_id: donorId,\n                message: name + \" \" + lastName + \" received the book \" + bookName,\n                notification_status: \"unread\",\n                book_name: bookName\n              });\n            });\n          });\n        });\n      });\n    };\n\n    _this.updateBookRequestStatus = function () {\n      db.collection(\"requested_books\").doc(_this.state.docId).update({\n        book_status: \"received\"\n      });\n      db.collection(\"users\").where(\"email_id\", \"==\", _this.state.userId).get().then(function (snapshot) {\n        snapshot.forEach(function (doc) {\n          db.collection(\"users\").doc(doc.id).update({\n            IsBookRequestActive: false\n          });\n        });\n      });\n    };\n\n    _this.renderItem = function (_ref) {\n      var item = _ref.item,\n          i = _ref.i;\n      var obj = {\n        title: item.volumeInfo.title,\n        selfLink: item.selfLink,\n        buyLink: item.saleInfo.buyLink,\n        imageLink: item.volumeInfo.imageLinks\n      };\n      return React.createElement(TouchableHighlight, {\n        style: styles.touchableopacity,\n        activeOpacity: 0.6,\n        underlayColor: \"#DDDDDD\",\n        onPress: function onPress() {\n          _this.setState({\n            showFlatlist: false,\n            bookName: item.volumeInfo.title\n          });\n        },\n        bottomDivider: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 7\n        }\n      }, React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 9\n        }\n      }, \" \", item.volumeInfo.title, \" \"));\n    };\n\n    _this.state = {\n      userId: firebase.auth().currentUser.email,\n      bookName: \"\",\n      reasonToRequest: \"\",\n      IsBookRequestActive: \"\",\n      requestedBookName: \"\",\n      bookStatus: \"\",\n      requestId: \"\",\n      userDocId: \"\",\n      docId: \"\",\n      Imagelink: \"#\",\n      dataSource: \"\",\n      requestedImageLink: \"\",\n      showFlatlist: false\n    };\n    return _this;\n  }\n\n  _createClass(BookRequestScreen, [{\n    key: \"createUniqueId\",\n    value: function createUniqueId() {\n      return Math.random().toString(36).substring(7);\n    }\n  }, {\n    key: \"getIsBookRequestActive\",\n    value: function getIsBookRequestActive() {\n      var _this2 = this;\n\n      db.collection(\"users\").where(\"email_id\", \"==\", this.state.userId).onSnapshot(function (querySnapshot) {\n        querySnapshot.forEach(function (doc) {\n          _this2.setState({\n            IsBookRequestActive: doc.data().IsBookRequestActive,\n            userDocId: doc.id\n          });\n        });\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getBookRequest();\n      this.getIsBookRequestActive();\n    }\n  }, {\n    key: \"getBooksFromApi\",\n    value: function getBooksFromApi(bookName) {\n      var books;\n      return _regeneratorRuntime.async(function getBooksFromApi$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              this.setState({\n                bookName: bookName\n              });\n\n              if (!(bookName.length > 2)) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 4;\n              return _regeneratorRuntime.awrap(BookSearch.searchbook(bookName, \"AIzaSyASyOjOtJla-X-b3io2eLoaUc_bIRFSIIc\"));\n\n            case 4:\n              books = _context2.sent;\n              this.setState({\n                dataSource: books.data,\n                showFlatlist: true\n              });\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.IsBookRequestActive === true) {\n        return React.createElement(View, {\n          style: {\n            flex: 1\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 9\n          }\n        }, React.createElement(View, {\n          style: {\n            flex: 0.1\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 11\n          }\n        }, React.createElement(MyHeader, {\n          title: \"Book Status\",\n          navigation: this.props.navigation,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }\n        })), React.createElement(View, {\n          style: styles.ImageView,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 11\n          }\n        }, React.createElement(Image, {\n          source: {\n            uri: this.state.requestedImageLink\n          },\n          style: styles.imageStyle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }\n        })), React.createElement(View, {\n          style: styles.bookstatus,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 11\n          }\n        }, React.createElement(Text, {\n          style: {\n            fontSize: RFValue(20)\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 13\n          }\n        }, \"Name of the book\"), React.createElement(Text, {\n          style: styles.requestedbookName,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }\n        }, this.state.requestedBookName), React.createElement(Text, {\n          style: styles.status,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }\n        }, \"Status\"), React.createElement(Text, {\n          style: styles.bookStatus,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 13\n          }\n        }, this.state.bookStatus)), React.createElement(View, {\n          style: styles.buttonView,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 11\n          }\n        }, React.createElement(TouchableOpacity, {\n          style: styles.button,\n          onPress: function onPress() {\n            _this3.sendNotification();\n\n            _this3.updateBookRequestStatus();\n\n            _this3.receivedBooks(_this3.state.requestedBookName);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }\n        }, React.createElement(Text, {\n          style: styles.buttontxt,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }\n        }, \"Book Recived\"))));\n      }\n\n      return React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: {\n          flex: 0.1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 9\n        }\n      }, React.createElement(MyHeader, {\n        title: \"Request Book\",\n        navigation: this.props.navigation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }\n      })), React.createElement(View, {\n        style: {\n          flex: 0.9\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 9\n        }\n      }, React.createElement(Input, {\n        style: styles.formTextInput,\n        label: \"Book Name\",\n        placeholder: \"Book name\",\n        containerStyle: {\n          marginTop: RFValue(60)\n        },\n        onChangeText: function onChangeText(text) {\n          return _this3.getBooksFromApi(text);\n        },\n        onClear: function onClear(text) {\n          return _this3.getBooksFromApi(\"\");\n        },\n        value: this.state.bookName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }\n      }), this.state.showFlatlist ? React.createElement(FlatList, {\n        data: this.state.dataSource,\n        renderItem: this.renderItem,\n        enableEmptySections: true,\n        style: {\n          marginTop: RFValue(10)\n        },\n        keyExtractor: function keyExtractor(item, index) {\n          return index.toString();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 13\n        }\n      }) : React.createElement(View, {\n        style: {\n          alignItems: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 13\n        }\n      }, React.createElement(Input, {\n        style: styles.formTextInput,\n        containerStyle: {\n          marginTop: RFValue(30)\n        },\n        multiline: true,\n        numberOfLines: 8,\n        label: \"Reason\",\n        placeholder: \"Why do you need the book\",\n        onChangeText: function onChangeText(text) {\n          _this3.setState({\n            reasonToRequest: text\n          });\n        },\n        value: this.state.reasonToRequest,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 15\n        }\n      }), React.createElement(TouchableOpacity, {\n        style: [styles.button, {\n          marginTop: RFValue(30)\n        }],\n        onPress: function onPress() {\n          _this3.addRequest(_this3.state.bookName, _this3.state.reasonToRequest);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 15\n        }\n      }, React.createElement(Text, {\n        style: styles.requestbuttontxt,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 17\n        }\n      }, \"Request\")))));\n    }\n  }]);\n\n  return BookRequestScreen;\n}(Component);\n\nexport { BookRequestScreen as default };\nvar styles = StyleSheet.create({\n  keyBoardStyle: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  formTextInput: {\n    width: \"75%\",\n    height: RFValue(35),\n    borderWidth: 1,\n    padding: 10\n  },\n  ImageView: {\n    flex: 0.3,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginTop: 20\n  },\n  imageStyle: {\n    height: RFValue(150),\n    width: RFValue(150),\n    alignSelf: \"center\",\n    borderWidth: 5,\n    borderRadius: RFValue(10)\n  },\n  bookstatus: {\n    flex: 0.4,\n    alignItems: \"center\"\n  },\n  requestedbookName: {\n    fontSize: RFValue(30),\n    fontWeight: \"500\",\n    padding: RFValue(10),\n    fontWeight: \"bold\",\n    alignItems: 'center',\n    marginLeft: RFValue(60)\n  },\n  status: {\n    fontSize: RFValue(20),\n    marginTop: RFValue(30)\n  },\n  bookStatus: {\n    fontSize: RFValue(30),\n    fontWeight: \"bold\",\n    marginTop: RFValue(10)\n  },\n  buttonView: {\n    flex: 0.2,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  buttontxt: {\n    fontSize: RFValue(18),\n    fontWeight: \"bold\",\n    color: \"#fff\"\n  },\n  touchableopacity: {\n    alignItems: \"center\",\n    backgroundColor: \"#DDDDDD\",\n    padding: 10,\n    width: \"90%\"\n  },\n  requestbuttontxt: {\n    fontSize: RFValue(20),\n    fontWeight: \"bold\",\n    color: \"#fff\"\n  },\n  button: {\n    width: \"75%\",\n    height: RFValue(60),\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: RFValue(50),\n    backgroundColor: \"#32867d\",\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 8\n    },\n    shadowOpacity: 0.44,\n    shadowRadius: 10.32,\n    elevation: 16\n  }\n});","map":{"version":3,"sources":["F:/Projects/Book Donation App/book-santa-stage-13/screens/BookRequestScreen.js"],"names":["React","Component","db","firebase","RFValue","SearchBar","ListItem","Input","MyHeader","BookSearch","BookRequestScreen","addRequest","bookName","reasonToRequest","userId","state","randomRequestId","createUniqueId","searchbook","books","collection","add","user_id","book_name","reason_to_request","request_id","book_status","date","firestore","FieldValue","serverTimestamp","image_link","data","volumeInfo","imageLinks","thumbnail","getBookRequest","where","get","then","snapshot","forEach","doc","id","update","IsBookRequestActive","setState","requestId","Alert","alert","receivedBooks","bookStatus","bookRequest","requestedBookName","requestedImageLink","docId","sendNotification","name","first_name","lastName","last_name","donorId","donor_id","targeted_user_id","message","notification_status","updateBookRequestStatus","renderItem","item","i","obj","title","selfLink","buyLink","saleInfo","imageLink","styles","touchableopacity","showFlatlist","auth","currentUser","email","userDocId","Imagelink","dataSource","Math","random","toString","substring","onSnapshot","querySnapshot","getIsBookRequestActive","length","flex","props","navigation","ImageView","uri","imageStyle","bookstatus","fontSize","requestedbookName","status","buttonView","button","buttontxt","formTextInput","marginTop","text","getBooksFromApi","index","alignItems","requestbuttontxt","StyleSheet","create","keyBoardStyle","justifyContent","width","height","borderWidth","padding","alignSelf","borderRadius","fontWeight","marginLeft","color","backgroundColor","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  View,\r\n  Text,\r\n  KeyboardAvoidingView,\r\n  StyleSheet,\r\n  TouchableOpacity,\r\n  ScrollView,\r\n  FlatList,\r\n  TouchableHighlight,\r\n  Alert,\r\n  Image,\r\n} from \"react-native\";\r\nimport db from \"../config\";\r\nimport firebase from \"firebase\";\r\nimport { RFValue } from \"react-native-responsive-fontsize\";\r\nimport { SearchBar, ListItem, Input } from \"react-native-elements\";\r\n\r\nimport MyHeader from \"../components/MyHeader\";\r\nimport { BookSearch } from \"react-native-google-books\";\r\n\r\nexport default class BookRequestScreen extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      userId: firebase.auth().currentUser.email,\r\n      bookName: \"\",\r\n      reasonToRequest: \"\",\r\n      IsBookRequestActive: \"\",\r\n      requestedBookName: \"\",\r\n      bookStatus: \"\",\r\n      requestId: \"\",\r\n      userDocId: \"\",\r\n      docId: \"\",\r\n      Imagelink: \"#\",\r\n      dataSource: \"\",\r\n      requestedImageLink: \"\",\r\n      showFlatlist: false,\r\n    };\r\n  }\r\n\r\n  createUniqueId() {\r\n    return Math.random().toString(36).substring(7);\r\n  }\r\n\r\n  addRequest = async (bookName, reasonToRequest) => {\r\n    var userId = this.state.userId;\r\n    var randomRequestId = this.createUniqueId();\r\n    var books = await BookSearch.searchbook(\r\n      bookName,\r\n      \"AIzaSyASyOjOtJla-X-b3io2eLoaUc_bIRFSIIc\"\r\n    );\r\n\r\n\r\n    db.collection(\"requested_books\").add({\r\n      user_id: userId,\r\n      book_name: bookName,\r\n      reason_to_request: reasonToRequest,\r\n      request_id: randomRequestId,\r\n      book_status: \"requested\",\r\n      date: firebase.firestore.FieldValue.serverTimestamp(),\r\n      image_link: books.data[0].volumeInfo.imageLinks.thumbnail,\r\n    });\r\n\r\n    await this.getBookRequest();\r\n    db.collection(\"users\")\r\n      .where(\"email_id\", \"==\", userId)\r\n      .get()\r\n      .then()\r\n      .then((snapshot) => {\r\n        snapshot.forEach((doc) => {\r\n          db.collection(\"users\").doc(doc.id).update({\r\n            IsBookRequestActive: true,\r\n          });\r\n        });\r\n      });\r\n\r\n    this.setState({\r\n      bookName: \"\",\r\n      reasonToRequest: \"\",\r\n      requestId: randomRequestId,\r\n    });\r\n\r\n    return Alert.alert(\"Book Requested Successfully\");\r\n  };\r\n\r\n  receivedBooks = (bookName) => {\r\n    var userId = this.state.userId;\r\n    var requestId = this.state.requestId;\r\n    db.collection(\"received_books\").add({\r\n      user_id: userId,\r\n      book_name: bookName,\r\n      request_id: requestId,\r\n      bookStatus: \"received\",\r\n    });\r\n  };\r\n\r\n  getIsBookRequestActive() {\r\n    db.collection(\"users\")\r\n      .where(\"email_id\", \"==\", this.state.userId)\r\n      .onSnapshot((querySnapshot) => {\r\n        querySnapshot.forEach((doc) => {\r\n          this.setState({\r\n            IsBookRequestActive: doc.data().IsBookRequestActive,\r\n            userDocId: doc.id,\r\n          });\r\n        });\r\n      });\r\n  }\r\n\r\n  getBookRequest = () => {\r\n    // getting the requested book\r\n    var bookRequest = db\r\n      .collection(\"requested_books\")\r\n      .where(\"user_id\", \"==\", this.state.userId)\r\n      .get()\r\n      .then((snapshot) => {\r\n        snapshot.forEach((doc) => {\r\n          if (doc.data().book_status !== \"received\") {\r\n            this.setState({\r\n              requestId: doc.data().request_id,\r\n              requestedBookName: doc.data().book_name,\r\n              bookStatus: doc.data().book_status,\r\n              requestedImageLink: doc.data().image_link,\r\n              docId: doc.id,\r\n            });\r\n          }\r\n        });\r\n      });\r\n  };\r\n\r\n  sendNotification = () => {\r\n    //to get the first name and last name\r\n    db.collection(\"users\")\r\n      .where(\"email_id\", \"==\", this.state.userId)\r\n      .get()\r\n      .then((snapshot) => {\r\n        snapshot.forEach((doc) => {\r\n          var name = doc.data().first_name;\r\n          var lastName = doc.data().last_name;\r\n\r\n          // to get the donor id and book nam\r\n          db.collection(\"all_notifications\")\r\n            .where(\"request_id\", \"==\", this.state.requestId)\r\n            .get()\r\n            .then((snapshot) => {\r\n              snapshot.forEach((doc) => {\r\n                var donorId = doc.data().donor_id;\r\n                var bookName = doc.data().book_name;\r\n\r\n                //targert user id is the donor id to send notification to the user\r\n                db.collection(\"all_notifications\").add({\r\n                  targeted_user_id: donorId,\r\n                  message:\r\n                    name + \" \" + lastName + \" received the book \" + bookName,\r\n                  notification_status: \"unread\",\r\n                  book_name: bookName,\r\n                });\r\n              });\r\n            });\r\n        });\r\n      });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getBookRequest();\r\n    this.getIsBookRequestActive();\r\n  }\r\n\r\n  updateBookRequestStatus = () => {\r\n    //updating the book status after receiving the book\r\n    db.collection(\"requested_books\").doc(this.state.docId).update({\r\n      book_status: \"received\",\r\n    });\r\n\r\n    //getting the  doc id to update the users doc\r\n    db.collection(\"users\")\r\n      .where(\"email_id\", \"==\", this.state.userId)\r\n      .get()\r\n      .then((snapshot) => {\r\n        snapshot.forEach((doc) => {\r\n          //updating the doc\r\n          db.collection(\"users\").doc(doc.id).update({\r\n            IsBookRequestActive: false,\r\n          });\r\n        });\r\n      });\r\n  };\r\n\r\n  async getBooksFromApi(bookName) {\r\n    this.setState({ bookName: bookName });\r\n    if (bookName.length > 2) {\r\n      var books = await BookSearch.searchbook(\r\n        bookName,\r\n        \"AIzaSyASyOjOtJla-X-b3io2eLoaUc_bIRFSIIc\"\r\n      );\r\n      this.setState({\r\n        dataSource: books.data,\r\n        showFlatlist: true,\r\n      });\r\n    }\r\n  }\r\n\r\n  //render Items  functionto render the books from api\r\n  renderItem = ({ item, i }) => {\r\n\r\n\r\n    let obj = {\r\n      title: item.volumeInfo.title,\r\n      selfLink: item.selfLink,\r\n      buyLink: item.saleInfo.buyLink,\r\n      imageLink: item.volumeInfo.imageLinks,\r\n    };\r\n\r\n    return (\r\n      <TouchableHighlight\r\n        style={styles.touchableopacity}\r\n        activeOpacity={0.6}\r\n        underlayColor=\"#DDDDDD\"\r\n        onPress={() => {\r\n          this.setState({\r\n            showFlatlist: false,\r\n            bookName: item.volumeInfo.title,\r\n          });\r\n        }}\r\n        bottomDivider\r\n      >\r\n        <Text> {item.volumeInfo.title} </Text>\r\n      </TouchableHighlight>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    if (this.state.IsBookRequestActive === true) {\r\n      return (\r\n        <View style={{ flex: 1}}>\r\n          <View\r\n            style={{\r\n              flex: 0.1,\r\n            }}\r\n          >\r\n            <MyHeader title=\"Book Status\" navigation={this.props.navigation} />\r\n          </View>\r\n          <View\r\n            style={styles.ImageView}\r\n          >\r\n            <Image\r\n              source={{ uri: this.state.requestedImageLink }}\r\n              style={styles.imageStyle}\r\n            />\r\n          </View>\r\n          <View\r\n            style={styles.bookstatus}\r\n          >\r\n            <Text\r\n              style={{\r\n                fontSize: RFValue(20),\r\n\r\n              }}\r\n            >\r\n              Name of the book\r\n            </Text>\r\n            <Text\r\n              style={styles.requestedbookName}\r\n            >\r\n              {this.state.requestedBookName}\r\n            </Text>\r\n            <Text\r\n              style={styles.status}\r\n            >\r\n              Status\r\n            </Text>\r\n            <Text\r\n              style={styles.bookStatus}\r\n            >\r\n              {this.state.bookStatus}\r\n            </Text>\r\n          </View>\r\n          <View\r\n            style={styles.buttonView}\r\n          >\r\n            <TouchableOpacity\r\n              style={styles.button}\r\n              onPress={() => {\r\n                this.sendNotification();\r\n                this.updateBookRequestStatus();\r\n                this.receivedBooks(this.state.requestedBookName);\r\n              }}\r\n            >\r\n              <Text\r\n                style={styles.buttontxt}\r\n              >\r\n                Book Recived\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      );\r\n    }\r\n    return (\r\n      <View style={{ flex: 1 }}>\r\n        <View style={{ flex: 0.1 }}>\r\n          <MyHeader title=\"Request Book\" navigation={this.props.navigation} />\r\n        </View>\r\n        <View style={{ flex: 0.9 }}>\r\n          <Input\r\n            style={styles.formTextInput}\r\n            label={\"Book Name\"}\r\n            placeholder={\"Book name\"}\r\n            containerStyle={{ marginTop: RFValue(60) }}\r\n            onChangeText={(text) => this.getBooksFromApi(text)}\r\n            onClear={(text) => this.getBooksFromApi(\"\")}\r\n            value={this.state.bookName}\r\n          />\r\n          {this.state.showFlatlist ? (\r\n            <FlatList\r\n              data={this.state.dataSource}\r\n              renderItem={this.renderItem}\r\n              enableEmptySections={true}\r\n              style={{ marginTop: RFValue(10) }}\r\n              keyExtractor={(item, index) => index.toString()}\r\n            />\r\n          ) : (\r\n            <View style={{ alignItems: \"center\" }}>\r\n              <Input\r\n                style={styles.formTextInput}\r\n                containerStyle={{ marginTop: RFValue(30) }}\r\n                multiline\r\n                numberOfLines={8}\r\n                label={\"Reason\"}\r\n                placeholder={\"Why do you need the book\"}\r\n                onChangeText={(text) => {\r\n                  this.setState({\r\n                    reasonToRequest: text,\r\n                  });\r\n                }}\r\n                value={this.state.reasonToRequest}\r\n              />\r\n              <TouchableOpacity\r\n                style={[styles.button, { marginTop: RFValue(30) }]}\r\n                onPress={() => {\r\n                  this.addRequest(\r\n                    this.state.bookName,\r\n                    this.state.reasonToRequest\r\n                  );\r\n                }}\r\n              >\r\n                <Text\r\n                  style={styles.requestbuttontxt}\r\n                >\r\n                  Request\r\n                </Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          )}\r\n        </View>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  keyBoardStyle: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n  },\r\n  formTextInput: {\r\n    width: \"75%\",\r\n    height: RFValue(35),\r\n    borderWidth: 1,\r\n    padding: 10,\r\n  },\r\n  ImageView:{\r\n    flex: 0.3,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    marginTop:20\r\n  },\r\n  imageStyle:{\r\n    height: RFValue(150),\r\n    width: RFValue(150),\r\n    alignSelf: \"center\",\r\n    borderWidth: 5,\r\n    borderRadius: RFValue(10),\r\n  },\r\n  bookstatus:{\r\n    flex: 0.4,\r\n    alignItems: \"center\",\r\n\r\n  },\r\n  requestedbookName:{\r\n    fontSize: RFValue(30),\r\n    fontWeight: \"500\",\r\n    padding: RFValue(10),\r\n    fontWeight: \"bold\",\r\n    alignItems:'center',\r\n    marginLeft:RFValue(60)\r\n  },\r\n  status:{\r\n    fontSize: RFValue(20),\r\n    marginTop: RFValue(30),\r\n  },\r\n  bookStatus:{\r\n    fontSize: RFValue(30),\r\n    fontWeight: \"bold\",\r\n    marginTop: RFValue(10),\r\n  },\r\n  buttonView:{\r\n    flex: 0.2,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  buttontxt:{\r\n    fontSize: RFValue(18),\r\n    fontWeight: \"bold\",\r\n    color: \"#fff\",\r\n  },\r\n  touchableopacity:{\r\n    alignItems: \"center\",\r\n    backgroundColor: \"#DDDDDD\",\r\n    padding: 10,\r\n    width: \"90%\",\r\n  },\r\n  requestbuttontxt:{\r\n    fontSize: RFValue(20),\r\n    fontWeight: \"bold\",\r\n    color: \"#fff\",\r\n  },\r\n  button: {\r\n    width: \"75%\",\r\n    height: RFValue(60),\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: RFValue(50),\r\n    backgroundColor: \"#32867d\",\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 8,\r\n    },\r\n    shadowOpacity: 0.44,\r\n    shadowRadius: 10.32,\r\n    elevation: 16,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}